From d5bea1bc2bd5304a454640ee0f814ad9272d3ecc Mon Sep 17 00:00:00 2001
From: Chris Feist <cfeist@redhat.com>
Date: Mon, 30 Apr 2012 16:30:48 -0500
Subject: [PATCH] Re-sync cluster.conf

---
 ricci/ccs/cluster.rng.in |  313 +++++++++++++++++++++++++++++++++++++++-------
 1 files changed, 265 insertions(+), 48 deletions(-)

diff --git a/ricci/ccs/cluster.rng.in b/ricci/ccs/cluster.rng.in
index 064e366..c1a2d50 100644
--- a/ricci/ccs/cluster.rng.in
+++ b/ricci/ccs/cluster.rng.in
@@ -144,26 +144,25 @@ To validate your cluster.conf against this schema, run:
     </optional>
     <optional>
      <element name="multicast" rha:description="The multicast element
-         provides the ability for a user to specify a multicast address
-         instead of using the multicast address generated by cman. If
+         provides the ability for a user to specify a multicast address,
+         port and TTL (Time To Live) instead of using cman defaults. If
          a user does not specify a multicast address, cman creates one. It
-         forms the upper 16 bits of the multicast address with 239.192 and
-         forms the lower 16 bits based on the cluster ID.">
-      <optional>
-       <attribute name="addr" rha:description="A multicast address specified
-         by a user. If you do specify a multicast address, you should
-         use the 239.192.x.x series that cman uses. Otherwise, using a
-         multicast address outside that range may cause unpredictable
-         results. For example, using 224.0.0.x (All hosts on the network)
-         may not be routed correctly, or even routed at all by some
-         hardware." rha:sample="239.192.0.1"/>
-      </optional>
-      <optional>
-       <attribute name="ttl" rha:description="Define the TTL (time to live) of
-         a multicast packets. Useful only if nodes are on different subnets and
-         a multicast router is available in between." rha:default="1"
-         rha:sample="24"/>
-      </optional>
+         forms the upper 16 bits of the multicast address with 239.192 for
+         IPv4 and ff15:: for IPv6 and forms the lower 16 bits based on
+         the cluster ID.">
+      <ref name="MULTICASTOPTS"/>
+     </element>
+    </optional>
+    <optional>
+     <element name="altmulticast" rha:description="The altmulticast element
+         provides the ability for a user to specify a multicast address,
+         port and TTL (Time To Live) instead of using cman defaults for
+         the alternate communication channel (RRP). If a user does not
+         specify an alternate multicast address, cman creates one. It
+         forms the upper 16 bits of the multicast address with 239.192 for
+         IPv4 and ff15:: for IPv6 and forms the lower 16 bits based on
+         the cluster ID + 1.">
+      <ref name="MULTICASTOPTS"/>
      </element>
     </optional>
    </element>
@@ -256,6 +255,15 @@ To validate your cluster.conf against this schema, run:
       calculated from retransmits_before_loss and token." rha:default="4"
       rha:sample="5"/>
    </optional>
+   <optional>
+    <attribute name="miss_count_const"
+      rha:description="This constant defines the maximum number of times
+      on receipt of a token a message is checked for retransmission before
+      retransmission occurs. This parameter is useful to modify for switches
+      that delay multicast packets compared to unicast packets.
+      The default setting works well for nearly all modern switches."
+      rha:default="5" rha:sample="10"/>
+   </optional>
    <!-- FIXME: The following description was adapted from the man page.
    It may be tool long for the schema document. Consider cutting text
    after the second sentence and referring the reader to the openais.conf
@@ -785,32 +793,11 @@ To validate your cluster.conf against this schema, run:
         dlm_controld(8)"/>
    </optional>
 
-   <optional>
-    <element name="altname" rha:description="Defines a second network
-        interface to use for corosync redundant ring mode. cman(5)">
-
-     <attribute name="name" rha:description="A second hostname or IP
-        address of the node. cman(5)"/>
-
-     <optional>
-      <attribute name="port" rha:description="The network port to use
-          on the second interface. cman(5)"/>
-     </optional>
-
-     <optional>
-      <attribute name="mcast" rha:description="The multicast address
-          to use on the second interface. cman(5)"/>
-     </optional>
-
-     <optional>
-      <attribute name="ttl" rha:description="The multicast TTL 
-          to use on the second interface. cman(5)"/>
-     </optional>
-    </element>
-   </optional>
-
    <interleave>
     <optional>
+     <ref name="ALTNAME"/>
+    </optional>
+    <optional>
      <ref name="FENCE"/>
     </optional>
     <optional>
@@ -1034,6 +1021,61 @@ To validate your cluster.conf against this schema, run:
 </element> <!-- cluster end -->
 </start>
 
+<!-- begin mcast definitions -->
+
+ <define name="MULTICASTOPTS">
+  <optional>
+   <attribute name="addr" rha:description="A multicast address specified
+    by a user. If you do specify a multicast address, you should
+    use the 239.192.x.x series that cman uses. Otherwise, using a
+    multicast address outside that range may cause unpredictable
+    results. For example, using 224.0.0.x (All hosts on the network)
+    may not be routed correctly, or even routed at all by some
+    hardware." rha:sample="239.192.0.1"/>
+  </optional>
+  <optional>
+   <attribute name="ttl" rha:description="Define the TTL (time to live) of
+    a multicast packets. Useful only if nodes are on different subnets and
+    a multicast router is available in between." rha:default="1"
+    rha:sample="24"/>
+  </optional>
+  <optional>
+   <attribute name="port">
+    <data type="nonNegativeInteger"/>
+   </attribute>
+  </optional>
+ </define>
+
+<!-- end mcast definitions -->
+
+<!-- begin node altname definitions -->
+
+ <define name="ALTNAME">
+    <element name="altname" rha:description="Defines a second network
+        interface to use for corosync redundant ring mode. cman(5)">
+
+     <attribute name="name" rha:description="A second hostname or IP
+        address of the node. cman(5)"/>
+
+     <optional>
+      <attribute name="port" rha:description="The network port to use
+          on the second interface. cman(5)"/>
+     </optional>
+
+     <optional>
+      <attribute name="mcast" rha:description="The multicast address
+          to use on the second interface. cman(5)"/>
+     </optional>
+
+     <optional>
+      <attribute name="ttl" rha:description="The multicast TTL 
+          to use on the second interface. cman(5)"/>
+     </optional>
+    </element>
+ </define>
+
+<!-- end node altname definitions -->
+
 <!-- begin node fence definitions -->
 
  <define name="FENCE">
@@ -1199,7 +1241,7 @@ To validate your cluster.conf against this schema, run:
 
 
   <define name="SAPDATABASE">
-    <element name="SAPDatabase" rha:description="SAP database resource agent">
+    <element name="SAPDatabase" rha:description="Manages any SAP database (based on Oracle, MaxDB, or DB2)">
       <choice>
       <group>
         <!-- rgmanager specific stuff -->
@@ -2308,6 +2350,9 @@ To validate your cluster.conf against this schema, run:
           <attribute name="migrate" rha:description="Migration type (live or pause, default = live)."/>
         </optional>
         <optional>
+          <attribute name="tunnelled" rha:description="Tunnel data over ssh to securely migrate virtual machines."/>
+        </optional>
+        <optional>
           <attribute name="path" rha:description="Path to virtual machine configuration files."/>
         </optional>
         <optional>
@@ -2885,7 +2930,35 @@ To validate your cluster.conf against this schema, run:
         </optional>
       </group>
 
-      <!-- No metadata for /usr/sbin/fence_brocade -->
+
+      <!-- fence_brocade -->
+      <group rha:name="fence_brocade" rha:description="Fence agent for Brocade over telnet">
+        <optional>
+          <attribute name="option"/> <!-- deprecated; for compatibility.  use "action" -->
+        </optional>
+        <optional>
+          <attribute name="action" rha:description="Fencing Action" />
+        </optional>
+        <optional>
+          <attribute name="ipaddr" rha:description="IP Address or Hostname" />
+        </optional>
+        <optional>
+          <attribute name="login" rha:description="Login Name" />
+        </optional>
+        <optional>
+          <attribute name="passwd" rha:description="Login password or passphrase" />
+        </optional>
+        <optional>
+          <attribute name="passwd_script" rha:description="Script to retrieve password" />
+        </optional>
+        <optional>
+          <attribute name="port" rha:description="Physical plug number or name of virtual machine" />
+        </optional>
+        <optional>
+          <attribute name="help" rha:description="Display help and exit" />
+        </optional>
+      </group>
+
 
       <!-- fence_cisco_mds -->
       <group rha:name="fence_cisco_mds" rha:description="Fence agent for Cisco MDS">
@@ -3046,7 +3119,47 @@ To validate your cluster.conf against this schema, run:
         </optional>
       </group>
 
-      <!-- No metadata for /usr/sbin/fence_drac -->
+
+      <!-- fence_drac -->
+      <group rha:name="fence_drac" rha:description="fencing agent for Dell Remote Access Card">
+        <optional>
+          <attribute name="option"/> <!-- deprecated; for compatibility.  use "action" -->
+        </optional>
+        <optional>
+          <attribute name="action" rha:description="Fencing Action" />
+        </optional>
+        <optional>
+          <attribute name="ipaddr" rha:description="IP Address or Hostname" />
+        </optional>
+        <optional>
+          <attribute name="login" rha:description="Login Name" />
+        </optional>
+        <optional>
+          <attribute name="passwd" rha:description="Login password or passphrase" />
+        </optional>
+        <optional>
+          <attribute name="passwd_script" rha:description="Script to retrieve password" />
+        </optional>
+        <optional>
+          <attribute name="cmd_prompt" rha:description="Force fence_drac to use cmd_prompt as the command prompt" />
+        </optional>
+        <optional>
+          <attribute name="drac_version" rha:description="Force fence_drac to treat the device as though it was for the specified drac version" />
+        </optional>
+        <optional>
+          <attribute name="module_name" rha:description="The module name of the blade when using DRAC/MC firmware." />
+        </optional>
+        <optional>
+          <attribute name="debug" rha:description="Debug file of the telnet interaction" />
+        </optional>
+        <optional>
+          <attribute name="delay" rha:description="Wait X seconds before fencing is started" />
+        </optional>
+        <optional>
+          <attribute name="help" rha:description="Display help and exit" />
+        </optional>
+      </group>
+
 
       <!-- fence_drac5 -->
       <group rha:name="fence_drac5" rha:description="Fence agent for Dell DRAC CMC/5">
@@ -3127,7 +3240,35 @@ To validate your cluster.conf against this schema, run:
         </optional>
       </group>
 
-      <!-- No metadata for /usr/sbin/fence_egenera -->
+
+      <!-- fence_egenera -->
+      <group rha:name="fence_egenera" rha:description="I/O Fencing agent for the Egenera BladeFrame">
+        <optional>
+          <attribute name="option"/> <!-- deprecated; for compatibility.  use "action" -->
+        </optional>
+        <optional>
+          <attribute name="action" rha:description="Fencing Action" />
+        </optional>
+        <optional>
+          <attribute name="cserver" rha:description="The cserver to ssh to. cserver can be in the form user@hostname to specify a different user to login as." />
+        </optional>
+        <optional>
+          <attribute name="pserver" rha:description="The pserver to operate on." />
+        </optional>
+        <optional>
+          <attribute name="user" rha:description="Login Name" />
+        </optional>
+        <optional>
+          <attribute name="lpan" rha:description="The lpan to operate on." />
+        </optional>
+        <optional>
+          <attribute name="delay" rha:description="Wait X seconds before fencing is started" />
+        </optional>
+        <optional>
+          <attribute name="help" rha:description="Display help and exit" />
+        </optional>
+      </group>
+
 
       <!-- fence_eps -->
       <group rha:name="fence_eps" rha:description="Fence agent for ePowerSwitch">
@@ -3803,7 +3944,83 @@ To validate your cluster.conf against this schema, run:
         </optional>
       </group>
 
-      <!-- No metadata for /usr/sbin/fence_rsb -->
+
+      <!-- fence_rsb -->
+      <group rha:name="fence_rsb" rha:description="I/O Fencing agent for Fujitsu-Siemens RSB">
+        <optional>
+          <attribute name="option"/> <!-- deprecated; for compatibility.  use "action" -->
+        </optional>
+        <optional>
+          <attribute name="action" rha:description="Fencing Action" />
+        </optional>
+        <optional>
+          <attribute name="ipaddr" rha:description="IP Address or Hostname" />
+        </optional>
+        <optional>
+          <attribute name="login" rha:description="Login Name" />
+        </optional>
+        <optional>
+          <attribute name="passwd" rha:description="Login password or passphrase" />
+        </optional>
+        <optional>
+          <attribute name="passwd_script" rha:description="Script to retrieve password" />
+        </optional>
+        <optional>
+          <attribute name="secure" rha:description="SSH connection" />
+        </optional>
+        <optional>
+          <attribute name="identity_file" rha:description="Identity file for ssh" />
+        </optional>
+        <optional>
+          <attribute name="cmd_prompt" rha:description="Force command prompt" />
+        </optional>
+        <optional>
+          <attribute name="inet4_only" rha:description="Forces agent to use IPv4 addresses only" />
+        </optional>
+        <optional>
+          <attribute name="inet6_only" rha:description="Forces agent to use IPv6 addresses only" />
+        </optional>
+        <optional>
+          <attribute name="ipport" rha:description="TCP port to use for connection with device" />
+        </optional>
+        <optional>
+          <attribute name="telnet_port" rha:description="TCP port to use for connection with device (default is 3172 for telnet)" />
+        </optional>
+        <optional>
+          <attribute name="verbose" rha:description="Verbose mode" />
+        </optional>
+        <optional>
+          <attribute name="debug" rha:description="Write debug information to given file" />
+        </optional>
+        <optional>
+          <attribute name="version" rha:description="Display version information and exit" />
+        </optional>
+        <optional>
+          <attribute name="help" rha:description="Display help and exit" />
+        </optional>
+        <optional>
+          <attribute name="separator" rha:description="Separator for CSV created by operation list" />
+        </optional>
+        <optional>
+          <attribute name="power_timeout" rha:description="Test X seconds for status change after ON/OFF" />
+        </optional>
+        <optional>
+          <attribute name="shell_timeout" rha:description="Wait X seconds for cmd prompt after issuing command" />
+        </optional>
+        <optional>
+          <attribute name="login_timeout" rha:description="Wait X seconds for cmd prompt after login" />
+        </optional>
+        <optional>
+          <attribute name="power_wait" rha:description="Wait X seconds after issuing ON/OFF" />
+        </optional>
+        <optional>
+          <attribute name="delay" rha:description="Wait X seconds before fencing is started" />
+        </optional>
+        <optional>
+          <attribute name="retry_on" rha:description="Count of attempts to retry power on" />
+        </optional>
+      </group>
+
 
       <!-- fence_sanbox2 -->
       <group rha:name="fence_sanbox2" rha:description="Fence agent for QLogic SANBox2 FC switches">
-- 
1.7.7.6

