From 636787356206e592367843d66d3a834225bb1625 Mon Sep 17 00:00:00 2001
From: Chris Feist <cfeist@redhat.com>
Date: Tue, 3 Mar 2015 14:23:40 -0600
Subject: [PATCH] When using secure switch also disable SSLv3

---
 ricci/ricci/SSLInstance.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ricci/ricci/SSLInstance.cpp b/ricci/ricci/SSLInstance.cpp
index 6fe4b85..f60b01f 100644
--- a/ricci/ricci/SSLInstance.cpp
+++ b/ricci/ricci/SSLInstance.cpp
@@ -178,7 +178,7 @@ SSLInstance::SSLInstance(ClientSocket sock, bool secure) :
 			if (!ctx) {
 				ctx = SSL_CTX_new(SSLv23_server_method());
 				if (secure)
-					SSL_CTX_set_options(ctx, SSL_OP_NO_SSLv2 | SSL_OP_NO_COMPRESSION);
+					SSL_CTX_set_options(ctx, SSL_OP_NO_SSLv2 | SSL_OP_NO_COMPRESSION | SSL_OP_NO_SSLv3);
 			}
 			if (!ctx)
 				throw String("SSL context creation failed");
-- 
2.1.0

